module.exports.config = {
    name: 'info',
    version: '1.1.1',
    hasPermssion: 0,
    credits: 'DC-Nam',// mod by Q.Huy
    description: 'Xem thÃ´ng tin ngÆ°á»i dÃ¹ng Facebook',
    commandCategory: 'Tiá»‡n Ã­ch',
    usages: '< tag|reply|uid|username >',
    cooldowns: 2
};
const {
    get
} = require('axios');
const {
    image
} = require('image-downloader');
const {
    createReadStream
} = require('fs-extra');
module.exports.run = async function({
    api, event, args, Threads, Currencies
}) {
    try {      
        var uqID = event.type == 'message_reply' ? event.messageReply.senderID: Object.keys(event.mentions).length != 0 ? Object.keys(event.mentions)[0]: !!args[0] && !!args[0] ? args[0]: event.senderID;
        uqID = await get(`https://golike.com.vn/func-api.php?user=${uqID}`);
        const {threadInfo = {adminIDs: []}} = await Threads.getData(event.threadID) || {};
        const ban = global.data.userBanned.has(uqID.data.data.uid) ?  "Äang bá»‹ cáº¥m" : "KhÃ´ng bá»‹ cáº¥m";
        var permission;
        if (global.config.SUPERADMIN.includes(uqID.data.data.uid)) permission = `SUPER ADMIN`;
else if
(global.config.ADMIN.includes(uqID.data.data.uid)) 
permission = `ADMIN`; else if (threadInfo.adminIDs.some(i => i.id == uqID.data.data.uid)) permission = `Quáº£n trá»‹ viÃªn`; else permission = `ThÃ nh viÃªn`;
        const ciesData = await Currencies.getData(uqID.data.data.uid);
        const userInfo = await api.getUserInfo(uqID.data.data.uid);
        const res = await get(`https://api-thanhali.thanhali.repl.co/infofacebook?apikey=ThanhAliVip_1234567890&id=${uqID.data.data.uid}`);
        const {uid,name,birthday,follower,gender,hometown,location,relationship_status,link,quotes,tichxanh} = res.data || {};
        const dest = `${__dirname}/cache/test.png`;
        await image({
            url: 'https://graph.facebook.com/' + uqID.data.data.uid + '/picture?height=720&width=720&access_token=6628568379%7Cc1e620fa708a1d5696fb991c1bde5662', dest
        });
        api.sendMessage({
            body: `
== ğˆğğ…ğ ğ…ğ€ğ‚ğ„ğğğğŠ ==\n
â†’ TÃªn: ${name}
â†’ Giá»›i tÃ­nh: ${(x = gender),x == 'female'?'Ná»¯' : x == 'male'?'Nam':'KhÃ´ng xÃ¡c Ä‘á»‹nh'}
â†’ NgÃ y sinh: ${birthday}
â†’ Äáº¿n tá»«: ${($h1=res.data.hometown),!!$h1?hometown.name:'KhÃ´ng cÃ³ dá»¯ liá»‡u'}
â†’ Sá»‘ng táº¡i: ${($h2=res.data.location),!!$h2?location.name:'KhÃ´ng cÃ³ dá»¯ liá»‡u'}
â†’ TÃ¬nh tráº¡ng: ${relationship_status}
â†’ XÃ¡c minh tÃ i khoáº£n: ${tichxanh ? "Báº­t" : "Táº¯t"}
â†’ NgÆ°á»i theo dÃµi: ${localeNum(follower)}
â†’ ID: ${uid}
â†’ LiÃªn káº¿t TCN: ${link}
â†’ Tham gia Facebook vÃ o: ${uqID.data.data.date}
â†’ Tráº¡ng thÃ¡i: ${userInfo[uqID.data.data.uid].isFriend ? 'CÃ³': 'KhÃ´ng'} káº¿t báº¡n vá»›i Bot
â†’ Sá»‘ dÆ° trÃªn Bot: ${localeNum(ciesData.money)}$
â†’ Chá»©c vá»¥ trong nhÃ³m: ${permission}
â†’ Kiá»ƒm tra cáº¥m: ${ban} dÃ¹ng Bot
`.replace(/null|undefined/g, 'KhÃ´ng cÃ³ dá»¯ liá»‡u').replace(/private/g, 'ThÃ´ng tin riÃªng tÆ°'), attachment: createReadStream(dest)
        }, event.threadID, event.messageID);
    }catch(e) {
        api.sendMessage(`${e}`, event.threadID, event.messageID);
    };
};
function localeNum(a){
    return (a.toLocaleString()).replace(/\,/g, '.');
};