module.exports.config = {
	name: "xsmb",
	version: "1.0.0",
	hasPermssion: 0,
	credits: "NTKhang",
	description: "xem k·∫øt qu·∫£ x·ªï s·ªë mi·ªÅn b·∫Øc",
	commandCategory: "other",
	cooldowns: 5
};

module.exports.run = async function ({ api, event, args }) {
	const axios = require('axios');
	const moment = require('moment-timezone');
	const currentHour = moment.tz("Asia/Ho_Chi_Minh").format("HH");
	const currentMinute = moment.tz("Asia/Ho_Chi_Minh").format("mm");

	let dayGetResult;
	if (currentHour > 18 || (currentHour == 18 && currentMinute >= 15))
		dayGetResult = moment.tz("Asia/Ho_Chi_Minh").format("DD-MM-YYYY");
	else
		dayGetResult = moment.tz("Asia/Ho_Chi_Minh").subtract(1, 'days').format("DD-MM-YYYY");
	if (args[0] && moment.tz(args[0], "DD-MM-YYYY", true, "Asia/Ho_Chi_Minh").isValid())
		dayGetResult = moment.tz(args[0], "DD-MM-YYYY", true, "Asia/Ho_Chi_Minh").format("DD-MM-YYYY");

	const response = await axios.get("https://api-thanhali.thanhali.repl.co/xsmb?date=" + dayGetResult);
	const data = response.data;

	api.sendMessage(`üéâ K·∫øt qu·∫£ x·ªï s·ªë mi·ªÅn B·∫Øc ng√†y ${data.date}\n`
		+ `\nM√£ gi·∫£i ƒë·∫∑c bi·ªát: ${data.maDB.join('  -  ')}`
		+ `\nGi·∫£i ƒë·∫∑c bi·ªát: ${data.giaiDB[0]}`
		+ `\nGi·∫£i nh·∫•t: ${data.giaiNhat[0]}`
		+ `\nGi·∫£i nh√¨: ${data.giaiNhi.join(" - ")}`
		+ `\nGi·∫£i ba: ${data.giaiBa.join(" - ")}`
		+ `\nGi·∫£i t∆∞: ${data.giaiTu.join(" - ")}`
		+ `\nGi·∫£i nƒÉm: ${data.giaiNam.join(" - ")}`
		+ `\nGi·∫£i s√°u: ${data.giaiSau.join(" - ")}`
		+ `\nGi·∫£i b·∫£y: ${data.giaiBay.join(" - ")}`, event.threadID, event.messageID);
};